---
title: "1. Species data"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 3
---

$~$

### Introduction

In this pre-course exercise, you will:

- Download species occurrence data
- Clean species occurrence data
- Generate data for a *virtual* species

$~$

### Getting Started

We will use the following packages:

<!-- - [`spocc`](https://docs.ropensci.org/spocc/) -->
- [`rgbif`](https://docs.ropensci.org/rgbif/index.html)
- [`CoordinateCleaner`](https://ropensci.github.io/CoordinateCleaner/)
- [`virtualspecies`](http://borisleroy.com/files/virtualspecies-tutorial.html)

$~$

### Obtaining data

- General principles
- From GBIF using `rgbif`

The `rgbif` package has a lot of functionality and [a detailed vignette here](http://borisleroy.com/files/virtualspecies-tutorial.html). In this short exercise, we will see a very abbreviated demonstration of using the package to download data for a set of focal species (*Coccoloba diversifolia*) from GBIF.

```{r}
library(rgbif)

myspecies <- c("Canis lupus")

myspecies <- "Coccoloba diversifolia"

# name_lookup(query=myspecies)

# occ_count(myspecies)

# Download GBIF occurrence data for this species.
# (this can takes some time if there are many data points!)

# Only include records from broadly Europe
gbif_data <- occ_data(scientificName = myspecies)


```

$~$






### Cleaning coordinates

WHY WE NEED TO CLEAN COORDINATES...

We will use the tutorial from the [`CoordinateCleaner` R Package](https://ropensci.github.io/CoordinateCleaner/articles/Cleaning_GBIF_data_with_CoordinateCleaner.html)


```{r}
library(CoordinateCleaner)
```



### Virtual species

Cut from the `embarcadero` vignette (Carlson 2020)

```{r, eval=F}
nelandscape <- function(x) {NLMR::nlm_gaussianfield(nrow = 150,
                                                     ncol = 150,
                                                     rescale = FALSE)}
climate <- stack(lapply(c(1:8), onelandscape))
xnames <- c('x1','x2','x3','x4','x5','x6','x7','x8')
names(climate) <- xnames

plot(climate[[1]],main='An imaginary variable', 
     box=F, axes=F)
```

